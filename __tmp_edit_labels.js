const fs = require('fs');
const path = 'src/components/map/EditorSidePanel.jsx';
let text = fs.readFileSync(path, 'utf8');
text = text.replace("  REGIONS: 'regions',\n};", "  REGIONS: 'regions',\n  LABELS: 'labels',\n};");
text = text.replace(
  "  canAssignSelection = false,\n  onAssignSelection,\n  selectedRegionName = '',\n  selectedLocationName = '',\n}) {",
  "  canAssignSelection = false,\n  onAssignSelection,\n  selectedRegionName = '',\n  selectedLocationName = '',\n  labels = [],\n  showMapLabels = true,\n  onToggleLabels,\n  onStartPlaceLabel,\n  isPlacingLabel = false,\n  onLabelFieldChange,\n  onDeleteLabel,\n  mapZoom = 0,\n}) {"
);
text = text.replace(
          <span className="editor-side-panel__home-eyebrow">Tools</span>\n        <strong>Regions</strong>\n        <p>Create areas, adjust colors, and assign markers.</p>\n      </button>\n      <div className="editor-side-panel__home-card editor-side-panel__home-card--disabled">,
          <span className="editor-side-panel__home-eyebrow">Tools</span>\n        <strong>Regions</strong>\n        <p>Create areas, adjust colors, and assign markers.</p>\n      </button>\n      <button\n        type="button"\n        className="editor-side-panel__home-card"\n        onClick={() => setView(PANEL_VIEWS.LABELS)}\n      >\n        <span className="editor-side-panel__home-eyebrow">Tools</span>\n        <strong>Labels</strong>\n        <p>Place curved labels for regions, castles, and notes.</p>\n      </button>\n      <div className="editor-side-panel__home-card editor-side-panel__home-card--disabled">
);
const renderRegionsNeedle = '  const renderRegions = () => (\n    <>\n      <div className="editor-side-panel__section">';
const labelBlock =   const labelFontOptions = [\n    { value: 'serif', label: 'Serif (Cinzel/Cormorant)' },\n    { value: 'sans', label: 'Sans (Inter)' },\n    { value: 'display', label: 'Display (Uncial)' },\n  ];\n\n  const labelColorOptions = ['#fef3c7', '#fde047', '#f97316', '#a5f3fc', '#c7d2fe', '#fbcfe8'];\n\n  const renderLabels = () => (\n    <div className="editor-side-panel__section">\n      <div className="editor-side-panel__section-header">\n        <h3>Map Labels</h3>\n        <p>Current zoom: {mapZoom.toFixed(2)}</p>\n      </div>\n      <div className="editor-side-panel__actions-grid">\n        <article className="editor-side-panel__action-card">\n          <header>\n            <h4>Create / Toggle Labels</h4>\n            <p>Add draggable labels and control their visibility.</p>\n          </header>\n          <div className="editor-side-panel__action-card-row">\n            <button\n              type="button"\n              className={\	oolbox-button \}\n              onClick={onStartPlaceLabel}\n            >\n              {isPlacingLabel ? 'Click map to place…' : 'Add Label'}\n            </button>\n            <label className="toggle-row">\n              <span>Show labels</span>\n              <input\n                type="checkbox"\n                checked={showMapLabels}\n                onChange={(event) => onToggleLabels?.(event.target.checked)}\n              />\n            </label>\n          </div>\n        </article>\n      </div>\n\n      <div className="editor-side-panel__section-header">\n        <h4>Label List</h4>\n        <p>\n          {labels.length || 0} label{labels.length === 1 ? '' : 's'}\n        </p>\n      </div>\n      <div className="region-list custom-scrollbar">\n        {labels.length === 0 && (\n          <p className="region-list__empty">No labels yet. Add one to begin.</p>\n        )}\n        {labels.map((label) => (\n          <div key={label.id} className="region-item region-item--label">\n            <div className="region-item__select">\n              <label className="editor-side-panel__field editor-side-panel__field--inline">\n                <span>Text</span>\n                <input\n                  type="text"\n                  value={label.text || ''}\n                  onChange={(event) => onLabelFieldChange?.(label.id, 'text', event.target.value)}\n                />\n              </label>\n            </div>\n            <div className="label-controls-grid">\n              <label className="editor-side-panel__field">\n                <span>Font</span>\n                <select\n                  value={label.font || 'serif'}\n                  onChange={(event) => onLabelFieldChange?.(label.id, 'font', event.target.value)}\n                >\n                  {labelFontOptions.map((opt) => (\n                    <option key={opt.value} value={opt.value}>\n                      {opt.label}\n                    </option>\n                  ))}\n                </select>\n              </label>\n              <label className="editor-side-panel__field">\n                <span>Color</span>\n                <select\n                  value={label.color || labelColorOptions[0]}\n                  onChange={(event) => onLabelFieldChange?.(label.id, 'color', event.target.value)}\n                >\n                  {labelColorOptions.map((c) => (\n                    <option key={c} value={c}>\n                      {c}\n                    </option>\n                  ))}\n                </select>\n              </label>\n            </div>\n            <div className="label-controls-grid">\n              <label className="editor-side-panel__field">\n                <span>Base size</span>\n                <input\n                  type="range"\n                  min="0.5"\n                  max="3"\n                  step="0.05"\n                  value={label.size || 1}\n                  onChange={(event) =>\n                    onLabelFieldChange?.(label.id, 'size', parseFloat(event.target.value))\n                  }\n                />\n              </label>\n              <label className="editor-side-panel__field">\n                <span>Zoom scale</span>\n                <input\n                  type="range"\n                  min="0.5"\n                  max="2"\n                  step="0.05"\n                  value={label.zoomScale || 1}\n                  onChange={(event) =>\n                    onLabelFieldChange?.(label.id, 'zoomScale', parseFloat(event.target.value))\n                  }\n                />\n              </label>\n            </div>\n            <div className="label-controls-grid">\n              <label className="editor-side-panel__field">\n                <span>Fade start</span>\n                <input\n                  type="range"\n                  min="0"\n                  max="8"\n                  step="0.1"\n                  value={label.fadeInStart ?? 3}\n                  onChange={(event) =>\n                    onLabelFieldChange?.(label.id, 'fadeInStart', parseFloat(event.target.value))\n                  }\n                />\n              </label>\n              <label className="editor-side-panel__field">\n                <span>Fade end</span>\n                <input\n                  type="range"\n                  min="0"\n                  max="8"\n                  step="0.1"\n                  value={label.fadeInEnd ?? 5}\n                  onChange={(event) =>\n                    onLabelFieldChange?.(label.id, 'fadeInEnd', parseFloat(event.target.value))\n                  }\n                />\n              </label>\n            </div>\n            <div className="region-item__actions">\n              <button type="button" onClick={() => onStartPlaceLabel?.()}>\n                Move\n              </button>\n              <button type="button" onClick={() => onDeleteLabel?.(label.id)}>\n                Delete\n              </button>\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n;
if(!text.includes('const renderLabels')){
  text = text.replace(renderRegionsNeedle, renderRegionsNeedle + '\n\n' + labelBlock);
}
text = text.replace(
  '    if (view === PANEL_VIEWS.MARKERS) return renderMarkers();\n    if (view === PANEL_VIEWS.REGIONS) return renderRegions();\n    return renderHome();',
  '    if (view === PANEL_VIEWS.MARKERS) return renderMarkers();\n    if (view === PANEL_VIEWS.REGIONS) return renderRegions();\n    if (view === PANEL_VIEWS.LABELS) return renderLabels();\n    return renderHome();'
);
text = text.replace(
  /<button\s*\n\s*type="button"\n\s*className=\{view === PANEL_VIEWS.REGIONS \? 'active' : ''\}\n\s*onClick=\{\(\) => setView\(PANEL_VIEWS.REGIONS\)\}\n\s*>\n\s*Regions\n\s*<\/button>\n\s*<\/div>/,
  <button\n            type="button"\n            className={view === PANEL_VIEWS.REGIONS ? 'active' : ''}\n            onClick={() => setView(PANEL_VIEWS.REGIONS)}\n          >\n            Regions\n          </button>\n          <button\n            type="button"\n            className={view === PANEL_VIEWS.LABELS ? 'active' : ''}\n            onClick={() => setView(PANEL_VIEWS.LABELS)}\n          >\n            Labels\n          </button>\n        </div>
);
fs.writeFileSync(path, text, 'utf8');
